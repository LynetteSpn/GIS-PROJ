<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>RMIS Basemap Switcher</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v8.2.0/ol.css">
        <link rel="stylesheet" href="https://unpkg.com/simplebar@latest/dist/simplebar.css" />
        <link rel="stylesheet" href="./stylermis.css">
        <link rel="stylesheet" href="./stylermis2.css">
        <link rel="stylesheet" href="./stylermis3.css">
    </head>

    <body>
        <div id="route-banner" class="route-banner"></div>
        <div id="map" class="map"></div>

        <div class="ol-control extend-control">
            <button id="center-button" title="Exxtend Map">E</button>
        </div>

        <div id="coords"> Lat: -, Lng: -</div>

        <div id="road-popup" class ="ol-popup" data-simplebar>
            <a href="#" id="road-popup-closer" class="ol-popup-closer">&times;</a>
            <div id="road-popup-content"></div>
        </div>

        <div id="toolbar" class="toolbar">
             <button id="minimize-toolbar" title="Minimize Toolbar">-</button>
            <div id="toolbar-content" class="toolbar-content">
                
                    <div id="toolbar-title" class="toolbar-title">Search</div>

                    <select id="districtFilter" title="Filter by District">
                            <option value="" disabled selected>Select District</option>
                            <option value="ALL">ALL DISTRICTS</option>
                            <option value="17">Beaufort</option>
                            <option value="08">Beluran</option>
                            <option value="13">Keningau</option>
                            <option value="09">Kinabatangan</option>
                            <option value="03">Kota Belud</option>
                            <option value="01">Kota Kinabalu</option>
                            <option value="22">Kota Marudu</option>
                            <option value="18">Kuala Penyu</option>
                            <option value="05">Kudat</option>
                            <option value="24">Kunak</option>
                            <option value="11">Lahad Datu</option>
                            <option value="15">Nabawan</option>
                            <option value="02">Papar</option>
                            <option value="21">Penampang</option>
                            <option value="23">Pitas</option>
                            <option value="27">Putatan</option>
                            <option value="06">Ranau</option>
                            <option value="07">Sandakan</option>
                            <option value="12">Semporna</option>
                            <option value="19">Sipitang</option>
                            <option value="14">Tambunan</option>
                            <option value="10">Tawau</option>
                            <option value="28">Telupid</option>
                            <option value="16">Tenom</option>
                            <option value="25">Tongod</option>
                            <option value="04">Tuaran</option>
                        </select>

                    <select id="filterBy" class="filterBy" onchange="filterBy(this.value)">
                        <option value="" disabled selected>Search By</option>
                        <option value="road_name">Road Name</option>
                        <option value="pkm_road_id">PKM ID</option>
                        <option value="marris_id">Marris ID</option>
                        <option value="zone_name">Zone Name</option>
                        <option value="taman">Area Name</option>
                        <option value="rdcat_code">Road Category</option>
                        <option value="dun_code">DUN Code</option>
                    </select>

                    <div class="search-wrapper"> 
                        <input type="text" id="roadSearch" placeholder="Search ">
                        <div id="autocomplete-list" class="autocomplete-items"></div>
                    </div>

                    <button id="resetButton" title="Reset Filters">Reset</button>
            </div>
        </div>

        <div id="side-toolbar" class="side-toolbar">
            <div id="sidebar-content" class="sidebar-content">
                <button id="legend-toggle-btn" title="Toggle Legend"><img src="legend.png"></button>
                <button id="switchBasemap" title="Switch Basemap"><img src="layers.png"></button>
                <button id="locate-btn" title="Locate Me"><img src="locate.png"></button>
                <button id="measure-btn" title="Measure Distance/Area"><img src="measure.png"></button>
                <!-- <button id="route-btn" title="Routing"><img src="direction.png"></button> -->
                <!-- <button id="optimize-btn" title="Multi-Stop Routing"><img src="optimisation.png"></button> -->
                <button id="planner-btn" title="Route Planner"><img src="direction.png"></button>
                <button id="chart-btn" title="Data Charts"><img src="chart.png"></button>
            </div>

            <div id="route-options-panel" class="route-options-panel">
            <div class="route-option-header"> <strong>Route Options</strong></div>
                <button id="btn-route-from-gps" class="route-option-btn" style="color: black;">From Current Location</button>
                <button id="btn-route-manual" class="route-option-btn" style="color: black;">Select on Map</button>
            </div>

                <div id="optimization-panel" class="optimization-panel" style="display: none; min-height: 250px; width: 280px;">
                    <div class="optimization-header">
                        <button id="btn-back-menu" style="display:none; background:none; border:none; color:white; cursor:pointer; font-weight:bold; margin-right:10px;">⬅</button>
                        <span class="optimization-title" id="opt-title">Route Planner</span>
                        <button id="btn-close-opt" class="optimization-close-btn">x</button>
                    </div>

                    <!-- Menu choices in #opt-main-menu (update markup to add these!) -->
                <div id="opt-main-menu">
                    <p style="font-size:12px; color:#666; margin-bottom:10px; text-align:center;">Choose route mode:</p>
                    <button id="btn-mode-gps" class="route-option-btn" style="color: black; ">From Current Location (1 stop) </button>
                    <button id="btn-mode-manualstart" class="route-option-btn" style="color: black;" >Manual Select Location (1 stop)</button>
                    <button id="btn-mode-multistop" class="route-option-btn" style="color: black;">Manual Select Location (Multi-Stop)</button>
                    <p style="font-size:12px; color:#666; margin-bottom:15px; text-align:center;">Work optimisation:</p>
                    <button id="btn-mode-bridge" class="route-option-btn" style="color: rgb(0, 22, 145);" >Scan Critical Bridges</button>
                    <button id="btn-mode-culvert" class="route-option-btn" style="color: rgb(109, 0, 0);" >Scan Critical Culverts</button>
                </div>

                    <div id="opt-workspace" style="display: none; flex-direction: column; ">
                        <div id="job-list" class="job-list-container" data-simplebar>
                            <div class="job-list-empty"><div class="empty-text">No jobs added</div></div>
                        </div>
                        
                        <div class="optimization-actions">
                            <button id="btn-add-jobs" class="optimization-btn btn-add">+ Add Locations</button>
                            <button id="btn-run-tsp" class="optimization-btn btn-optimize">Optimize Route</button>
                            <button id="btn-clear-jobs" class="optimization-btn btn-clear">Clear List</button>
                        </div>
                    </div>
            </div>

                   
        </div>

        <div id="adding-mode-bar" class="floating-action-bar" style="display: none;">
            <span id="adding-count" style="margin-right: 15px; font-weight: bold;">Selected</span>
            <button id="btn-finish-adding" style="background: white; border: none; color: #007bff; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-weight: bold;">
                DONE
            </button>
        </div>

       
 <!-- Floating Dashboard Panel -->
                    <div id="dashboard-panel">
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <div id="dashboard-header" >Dashboard</div>
                            <button id="dashboard-close-btn">×</button>
                        </div>
                        <canvas id="dashboard-asset-chart"></canvas>
                        <canvas id="dashboard-type-chart"></canvas>
                        <div id="condition-summary"></div>
                    </div>
        <!-- Dashboard Open Button -->
        

        <div id="legend" class="legend">
            <button id="minimize-legend" title="Minimize Legend">-</button>
            <div class="legend-content" data-simplebar>
                <b>LEGEND</b>
                <div class="layer-group">
                    <label class="group-label">
                        <input type="checkbox" id="sabahRoadCheckbox" checked />
                        <strong>Sabah Roads</strong>
                        <button id="toggleRoadTypes" class="collapse-toggle" title="Collapse/Expand"><b>-</b></button>
                    </label>
                    <div id="roadTypeItemsContainer" class="layer-list"></div>
                    
                    <div class="layer-list">
                        <label>
                            <input type="checkbox" id="chainageCheckbox" class="layer-checkbox" data-layer="chainageLayer" />
                            <strong>Chainages</strong>
                            <button id="toggleChainage" class="toggle-group" title="Collapse/Expand"><b>-</b></button>
                        </label>
                        <div id="chainageTypeItemsContainer" class="layer-list"></div>
                    </div>
                    
                    <div class="lmc-road">
                        <label>
                            <input type="checkbox" id="lmcCheckbox" class="lmcCheckbox" data-layer="lmcLayer">
                            <strong>LRM Roads</strong>
                            <button id="toggleLMC" class="toggle-list" title="Collapse/Expand"><b>-</b></button>
                        </label>
                        <div id="lrmItemsContainer" class="layer-list"></div>
                    </div>

                    <div class="bridges-layer">
                        <label>
                            <input type="checkbox" id="BCCheckbox" class="BCCheckbox" data-layer="BCLayer">
                            <strong>Bridges & Culverts</strong>
                            <button id="toggleBC" class="toggle-BC" title="Collapse/Expand"><b>-</b></button>
                        </label>
                        <div id="BCItemsContainer" class="layer-list"></div>
                    </div>
            </div>
        </div>

        

        <script src="https://cdn.jsdelivr.net/npm/ol@v8.2.0/dist/ol.js"></script>
        <script src="https://unpkg.com/simplebar@latest/dist/simplebar.min.js"></script>
        <script src = "https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
        <script src="rmis.js"></script> 
        <script src="rmis2.js"></script>
        <script src="rmis3.js"></script>
        <script src="rmis4.js"></script>
    </body>
</html>